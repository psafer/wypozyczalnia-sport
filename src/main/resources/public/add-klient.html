<!doctype html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>Dodaj Klienta</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet" />
    <style>
      body {
        font-family: Arial, sans-serif;
        padding-bottom: 50px;
      }
      .form-container {
        max-width: 600px;
        margin: 0 auto;
      }
    </style>
  </head>

  <body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
      <div class="container">
        <a class="navbar-brand" href="index.html">Wypożyczalnia</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="sprzet.html">Sprzęt</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="add-sprzet.html">Dodaj sprzęt</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="rezerwacje.html">Rezerwacje</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="add-rezerwacja.html"
                >Dodaj rezerwację</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="klienci.html">Klienci</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container mt-3">
      <div class="form-container card shadow-sm">
        <div class="card-header bg-white">
          <h2 class="h4 mb-0">Dodaj nowego klienta</h2>
        </div>
        <div class="card-body">
          <form id="addClientForm">
            <div class="mb-3">
              <label for="firstName" class="form-label">Imię</label>
              <input type="text" class="form-control" id="firstName" required />
            </div>

            <div class="mb-3">
              <label for="lastName" class="form-label">Nazwisko</label>
              <input type="text" class="form-control" id="lastName" required />
            </div>

            <div class="mb-3">
              <label for="phone" class="form-label">Telefon</label>
              <input
                type="tel"
                class="form-control"
                id="phone"
                placeholder="np. 123 456 789"
                required />
            </div>

            <div class="mb-3">
              <label for="documentId" class="form-label">Numer dokumentu</label>
              <input
                type="text"
                class="form-control"
                id="documentId"
                placeholder="np. dowód osobisty"
                required />
            </div>

            <div class="d-flex justify-content-end gap-2">
              <a href="klienci.html" class="btn btn-secondary">Anuluj</a>
              <button type="submit" class="btn btn-success">
                Zapisz klienta
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      document
        .getElementById("addClientForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          // Pobranie danych z formularza
          const clientData = {
            firstName: document.getElementById("firstName").value,
            lastName: document.getElementById("lastName").value,
            phone: document.getElementById("phone").value,
            documentId: document.getElementById("documentId").value,
          };

          const nameRegex = /^[a-zA-ZąćęłńóśźżĄĆĘŁŃÓŚŹŻ\s-]+$/;
          if (
            !nameRegex.test(clientData.firstName) ||
            !nameRegex.test(clientData.lastName)
          ) {
            alert("Błąd: Imię i nazwisko nie mogą zawierać cyfr");
            return;
          }

          const phoneRegex = /^[0-9\s-]+$/;

          if (!phoneRegex.test(clientData.phone)) {
            alert("Błąd: Numer telefonu musi składać się z cyfr");
            return;
          }
          // Wysłanie danych do backendu
          fetch("/klienci", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(clientData),
          })
            .then((response) => {
              if (response.ok) {
                // Przekierowanie do listy klientów po sukcesie
                window.location.href = "klienci.html";
              } else {
                alert(
                  "Błąd podczas dodawania klienta. Kod błędu: " +
                    response.status,
                );
              }
            })
            .catch((error) => {
              console.error("Błąd:", error);
              alert("Wystąpił problem z połączeniem.");
            });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
