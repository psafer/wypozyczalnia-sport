<!doctype html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>Dodaj Klienta</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet" />
       <link
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
  rel="stylesheet"
/>
  </head>

<body class="bg-light d-flex flex-column min-vh-100">
    <div id="header"></div>
    <main class="flex-grow-1">
    <div class="container mt-3">
      <div class="form-container card shadow-sm">
        <div class="card-header bg-white">
          <h2 class="h4 mb-0">Dodaj nowego klienta</h2>
        </div>
        <div class="card-body">
          <form id="addClientForm">
            <div class="mb-3">
              <label for="firstName" class="form-label">Imię</label>
              <input type="text" class="form-control" id="firstName" required />
            </div>

            <div class="mb-3">
              <label for="lastName" class="form-label">Nazwisko</label>
              <input type="text" class="form-control" id="lastName" required />
            </div>

            <div class="mb-3">
              <label for="phone" class="form-label">Telefon</label>
              <input
                type="tel"
                class="form-control"
                id="phone"
                placeholder="np. 123 456 789"
                required />
            </div>

            <div class="mb-3">
              <label for="documentId" class="form-label">Numer dokumentu</label>
              <input
                type="text"
                class="form-control"
                id="documentId"
                placeholder="np. dowód osobisty"
                required />
            </div>

            <div class="d-flex justify-content-end gap-2">
              <a href="klienci.html" class="btn btn-secondary">Anuluj</a>
              <button type="submit" class="btn btn-success">
                Zapisz klienta
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
</main>
    <script>
      document
        .getElementById("addClientForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          // Pobranie danych z formularza
          const clientData = {
            firstName: document.getElementById("firstName").value,
            lastName: document.getElementById("lastName").value,
            phone: document.getElementById("phone").value,
            documentId: document.getElementById("documentId").value,
          };

          const nameRegex = /^[a-zA-ZąćęłńóśźżĄĆĘŁŃÓŚŹŻ\s-]+$/;
          if (
            !nameRegex.test(clientData.firstName) ||
            !nameRegex.test(clientData.lastName)
          ) {
            alert("Błąd: Imię i nazwisko nie mogą zawierać cyfr");
            return;
          }

          const phoneRegex = /^[0-9\s-]+$/;

          if (!phoneRegex.test(clientData.phone)) {
            alert("Błąd: Numer telefonu musi składać się z cyfr");
            return;
          }
          // Wysłanie danych do backendu
          fetch("/klienci", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(clientData),
          })
            .then((response) => {
              if (response.ok) {
                // Przekierowanie do listy klientów po sukcesie
                window.location.href = "klienci.html";
              } else {
                alert(
                  "Błąd podczas dodawania klienta. Kod błędu: " +
                    response.status,
                );
              }
            })
            .catch((error) => {
              console.error("Błąd:", error);
              alert("Wystąpił problem z połączeniem.");
            });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
  fetch("header.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("header").innerHTML = html;

      const current = window.location.pathname.split("/").pop();
      document.querySelectorAll(".nav-link").forEach(link => {
        if (link.getAttribute("href") === current) {
          link.classList.add("active");
        }
      });
    });
     fetch("footer.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("footer").innerHTML = html;
    });
</script>
<div id="footer"></div>

  </body>
</html>
